# üß† Smart Planner

**Smart Planner** ‚Äî AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–π —É–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–¥–∞—á–∞–º–∏, —Å–æ–±—ã—Ç–∏—è–º–∏ –∏ –≤—Ä–µ–º–µ–Ω–µ–º, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ —Å —É—á—ë—Ç–æ–º —Ä–µ–∞–ª—å–Ω—ã—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π, –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–π –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

–ü—Ä–æ–µ–∫—Ç –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å, AI-–¥–∏–∞–ª–æ–≥–æ–≤–æ–µ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ, Telegram-–±–æ—Ç–∞ –∏ —Å–∏—Å—Ç–µ–º—É –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π –≤ –µ–¥–∏–Ω—É—é —Å—Ä–µ–¥—É —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–µ–º.

üîó Repository: https://github.com/Stepa-Karpik/Smart-Planner

---

## ‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### üß† AI –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ

* –ø–æ–Ω–∏–º–∞–Ω–∏–µ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —è–∑—ã–∫–∞
* —Å–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π —á–µ—Ä–µ–∑ –¥–∏–∞–ª–æ–≥
* –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è
* –∞–Ω–∞–ª–∏–∑ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤
* —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—é

### üìÖ –ö–∞–ª–µ–Ω–¥–∞—Ä—å

* —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è–º–∏
* –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è —Å–æ–±—ã—Ç–∏—è
* –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è
* –ø–µ—Ä–µ–Ω–æ—Å –∑–∞–¥–∞—á
* –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã–ø–æ–ª–Ω–∏–º–æ—Å—Ç–∏

### üåç –ì–µ–æ–ª–æ–∫–∞—Ü–∏—è –∏ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è

* —Ä–∞—Å—á–µ—Ç –≤—Ä–µ–º–µ–Ω–∏ –≤ –ø—É—Ç–∏
* —É—á–µ—Ç –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–π –º–µ–∂–¥—É —Å–æ–±—ã—Ç–∏—è–º–∏
* –¥–æ–º–∞—à–Ω—è—è –ª–æ–∫–∞—Ü–∏—è
* –≥–µ–æ—Å–∞–¥–∂–µ—Å—Ç

### üîî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

* Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
* –æ—Ç–ª–æ–∂–µ–Ω–Ω—ã–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è
* —Ñ–æ–Ω–æ–≤—ã–µ –≤–æ—Ä–∫–µ—Ä—ã

### ü§ñ Telegram –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

* deep-link –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
* –±—ã—Å—Ç—Ä—ã–µ –∫–æ–º–∞–Ω–¥—ã
* AI –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ
* push —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

---

## üèó –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
Frontend (Next.js)
        ‚îÇ
        ‚ñº
FastAPI Backend ‚îÄ‚îÄ‚îÄ PostgreSQL
        ‚îÇ
        ‚îú‚îÄ‚îÄ Redis
        ‚îú‚îÄ‚îÄ AI Worker
        ‚îú‚îÄ‚îÄ Notification Worker
        ‚îî‚îÄ‚îÄ Telegram Bot
```

---

## üß∞ –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

### Backend

* FastAPI (async)
* PostgreSQL
* Redis
* SQLAlchemy 2
* Alembic
* aiogram 3
* LLM providers (OpenAI / DeepSeek)
* Docker

### Frontend

* Next.js (App Router)
* React
* TypeScript
* Leaflet
* shadcn/ui

### Infrastructure

* Docker Compose
* Worker-based architecture
* Redis queues
* Background processing

---

## üì¶ –ó–∞–ø—É—Å–∫

### –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
git clone https://github.com/Stepa-Karpik/Smart-Planner
cd Smart-Planner
```

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
cp .env.example .env
```

–ó–∞–ø–æ–ª–Ω–∏—Ç—å:

* –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
* Redis
* Telegram token
* AI provider –∫–ª—é—á–∏
* –≥–µ–æ API –∫–ª—é—á–∏

### –ó–∞–ø—É—Å–∫

```bash
docker compose up --build
```

### –ú–∏–≥—Ä–∞—Ü–∏–∏

```bash
docker compose run migrator alembic upgrade head
```

---

## üåê –°–µ—Ä–≤–∏—Å—ã

| —Å–µ—Ä–≤–∏—Å    | –æ–ø–∏—Å–∞–Ω–∏–µ           |
| --------- | ------------------ |
| API       | –æ—Å–Ω–æ–≤–Ω–æ–π backend   |
| AI worker | –æ–±—Ä–∞–±–æ—Ç–∫–∞ AI –∑–∞–¥–∞—á |
| worker    | —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è        |
| bot       | Telegram –±–æ—Ç       |
| redis     | –±—Ä–æ–∫–µ—Ä             |
| postgres  | –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö        |

---

## üîê Telegram –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è deep-link —Ñ–æ—Ä–º–∞—Ç:

```
https://t.me/<BOT_USERNAME>?start=<code>
```

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–≤—è–∑—ã–≤–∞–µ—Ç Telegram —Å –∞–∫–∫–∞—É–Ω—Ç–æ–º –≤–Ω—É—Ç—Ä–∏ —Å–µ—Ä–≤–∏—Å–∞.

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```
backend/
  app/
    api/
    services/
    models/
    repositories/
    workers/
    bot/

frontend/
ai-assistant/
docker-compose.yml
```

---

## ü§ñ AI Assistant v2

AI Assistant v2 –≤—ã–¥–µ–ª–µ–Ω –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π FastAPI –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–º Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ.

### –ü–æ—Ç–æ–∫ —Ä–∞–±–æ—Ç—ã

1. Backend –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç `POST /v1/ai/interpret` —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º
2. Backend –≤—ã–ø–æ–ª–Ω—è–µ—Ç –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—É—é –≤–∞–ª–∏–¥–∞—Ü–∏—é
3. Backend –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç `POST /v1/ai/propose`
4. Backend –ø—Ä–∏–º–µ–Ω—è–µ—Ç –¥–µ–π—Å—Ç–≤–∏—è —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏


Smart Planner ‚Äî —Å–∏—Å—Ç–µ–º–∞ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è, –≥–¥–µ AI –Ω–µ –ø—Ä–æ—Å—Ç–æ —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç —Å–æ–±—ã—Ç–∏—è, –∞ –ø–æ–º–æ–≥–∞–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Ä–µ—à–µ–Ω–∏—è –æ –≤—Ä–µ–º–µ–Ω–∏.

---

## Routes Provider Priority (ORS / Yandex / Mock)

- Add `OPENROUTESERVICE_API_KEY` to local `.env` to enable OpenRouteService routing.
- Provider priority: `OpenRouteService -> Yandex -> Mock`.
- Runtime fallback: ORS failure -> Yandex (if configured) -> Mock.

### geometry_latlon

- Backend returns `geometry_latlon` in `[lat, lon]` format for frontend route rendering.
- Use `geometry_latlon` for both Leaflet and Yandex Maps.
- ORS raw geometry `[lon, lat]` is converted in backend.
